- name: Build builder
  tag: builder
  service: make
  command: make build-builder TAG=${CI_BRANCH} COMMIT=${CI_REPO_NAME}/${CI_COMMIT_ID} BUILD=${CI_BUILD_ID} MAINTAINER=${CI_COMMITTER_NAME}<${CI_COMMITTER_EMAIL}>
- name: Build service
  exclude: builder
  service: make
  command: make build TAG=${CI_BRANCH} COMMIT=${CI_REPO_NAME}/${CI_COMMIT_ID} BUILD=${CI_BUILD_ID} MAINTAINER=${CI_COMMITTER_NAME}<${CI_COMMITTER_EMAIL}>

- name: Code coverage
  exclude: builder
  service: make
  command: make codecov-branch TAG=${CI_BRANCH}

- name: Release service
  tag: master
  service: make
  command: make release-service TAG=${CI_BRANCH}
- name: Release builder
  tag: builder
  service: make
  command: make release-builder TAG=${CI_BRANCH}